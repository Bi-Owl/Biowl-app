# Database Model Documentation

This document provides an overview of the database models used in the application, defined using Sequelize.

---

## 1. User

The `User` model represents an individual user account in the system.

**File:** `backend/models/user.js`

### Fields

| Field         | Type            | Constraints                               |
|---------------|-----------------|-------------------------------------------|
| `id`          | `INTEGER`       | Primary Key, Auto-increment               |
| `firstName`   | `STRING`        | Not Null                                  |
| `lastName`    | `STRING`        | Not Null                                  |
| `phoneNumber` | `STRING`        | Not Null, Unique                          |
| `nationalId`  | `STRING`        | Not Null, Unique                          |
| `email`       | `STRING`        | Not Null, Unique, Valid email format      |
| `password`    | `STRING`        | Not Null                                  |

### Scopes

- **`defaultScope`**: By default, queries for users will exclude the `password` field for security.
- **`withPassword`**: This scope can be explicitly used to include the `password` field in a query, which is necessary for login validation.

### Relationships

- **Has many-to-many with `Exam`**: A user can be associated with multiple exams, and an exam can have multiple users. This relationship is managed through the `UserExam` model.

---

## 2. Exam

The `Exam` model represents a test or an assessment that users can take.

**File:** `backend/models/exam.js`

### Fields

| Field           | Type      | Constraints                     | Description                                                              |
|-----------------|-----------|---------------------------------|--------------------------------------------------------------------------|
| `id`            | `INTEGER` | Primary Key, Auto-increment     | The unique identifier for the exam.                                      |
| `name`          | `STRING`  | Not Null                        | The name or title of the exam.                                           |
| `description`   | `TEXT`    | Nullable                        | A detailed description of the exam.                                      |
| `startTime`     | `DATE`    | Nullable                        | The date and time when the exam becomes available. `null` for timeless exams. |
| `endTime`       | `DATE`    | Nullable                        | The date and time when the exam closes. `null` for timeless exams.        |
| `isHidden`      | `BOOLEAN` | Not Null, Default: `false`      | If `true`, the exam is hidden from public lists.                         |
| `isPurchasable` | `BOOLEAN` | Not Null, Default: `true`       | If `true`, the exam can be purchased by users.                           |
| `price`         | `STRING`  | Not Null, Default: `'free'`     | The price of the exam. Can be a numeric string or the word 'free'.       |

### Relationships

- **Has many-to-many with `User`**: An exam can be associated with multiple users. This relationship is managed through the `UserExam` model.

---

## 3. UserExam

This model is a **join table** that connects the `User` and `Exam` models, representing the status of an exam for a specific user (e.g., whether it has been purchased).

**File:** `backend/models/userExam.js`

### Fields

| Field       | Type      | Constraints                     | Description                                                              |
|-------------|-----------|---------------------------------|--------------------------------------------------------------------------|
| `id`        | `INTEGER` | Primary Key, Auto-increment     | The unique identifier for this association record.                       |
| `purchased` | `BOOLEAN` | Not Null, Default: `false`      | If `true`, indicates that the user has purchased the associated exam.    |
| `UserId`    | `INTEGER` | Foreign Key                     | References the `id` of the associated user in the `Users` table.         |
| `ExamId`    | `INTEGER` | Foreign Key                     | References the `id` of the associated exam in the `Exams` table.         |

*Note: `UserId` and `ExamId` are automatically generated by Sequelize based on the `belongsToMany` association defined in `server.js`.*

### Relationships

- **Belongs to `User`**: Each `UserExam` record is linked to one user.
- **Belongs to `Exam`**: Each `UserExam` record is linked to one exam.
